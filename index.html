<!DOCTYPE html>
<html>
<head>

</head>
<body>
<h1>Coinvert!</h1>
<div id="btc"></div>
<div id="container">

<input type="text" id="bi" onchange="CryptoConvert(this);" onkeyup="CryptoConvert(this);"/> 
<input type="text" name="ci" id="ci"onchange="FiatConvert(this);" onkeyup="FiatConvert(this);"/> 
<form action="#" method="post">

<select name="Crypto" id="Crypto" onchange="changeCurrency();">
<option value="Bitcoin">Bitcoin</option>
<option value="Ethereum">Ethereum</option>
<option value="Dash">Dash</option>
<option value="Iota">Iota</option>
<option value="Ripple">Ripple</option>
</select>

<select name="Fiat" id="Fiat" onchange="changeCurrency();">
<option value="AUD">AUD</option>
<option value="BRL">BRL</option>
<option value="CAD">CAD</option>
<option value="CHF">CHF</option>
<option value="CLP">CLP</option>
<option value="CNY">CNY</option>
<option value="CZK">CZK</option>
<option value="DKK">DKK</option>
<option value="EUR">EUR</option>
<option value="GBP">GBP</option>
<option value="HKD">HKD</option>
<option value="HUF">HUF</option>
<option value="IDR">IDR</option>
<option value="ILS">ILS</option>
<option value="INR">INR</option>
<option value="JPY">JPY</option>
<option value="KRW">KRW</option>
<option value="MXN">MXN</option>
<option value="MYR">MYR</option>
<option value="NOK">NOK</option>
<option value="NZD">NZD</option>
<option value="PHP">PHP</option>
<option value="PKR">PKR</option>
<option value="PLN">PLN</option>
<option value="RUB">RUB</option>
<option value="SEK">SEK</option>
<option value="SGD">SGD</option>
<option value="THB">THB</option>
<option value="TRY">TRY</option>
<option value="TWD">TWD</option>
<option value="ZAR">ZAR</option>
</select>
</form>

<script>
var ourRequest = new XMLHttpRequest();
ourRequest.open('GET', 'https://api.coinmarketcap.com/v1/ticker/bitcoin/');
ourRequest.onload = function(){
var ourData = JSON.parse(ourRequest.responseText);
var cur = ourData[0]["price_usd"];
}
function changeCurrency() {
    var dpdCrypto = document.getElementById('Crypto');
    var dpdFiat = document.getElementById('Fiat');
    var fiat = dpdFiat.options[dpdFiat.selectedIndex].value;
    var crypto = dpdCrypto.options[dpdCrypto.selectedIndex].value;
    if(fiat && crypto != null){
        ourRequest.open('GET', 'https://api.coinmarketcap.com/v1/ticker/' + crypto + '/?convert=' + fiat);
        ourRequest.onload = function(){
        ourData = JSON.parse(ourRequest.responseText);
        cur = ourData[0]["price_" + fiat.toLowerCase()];
        console.log(cur);
            }
        }
    else{
        ourRequest.open('GET','https://api.coinmarketcap.com/v1/ticker/bitcoin/');
        ourRequest.onload = function(){
        ourData = JSON.parse(ourRequest.responseText);
        cur = ourData[0]["price_usd"];
        console.log(cur);
    }
}
ourRequest.send();
}
    function CryptoConvert(input){
        // too slow
        var price = cur; 
        var output = input.value * price;
        var co = document.getElementById('ci');
        ci.value = output; 
    }

    function FiatConvert(input){
        var price = cur; 
        var output = input.value / price;
        var co = document.getElementById('bi');
        bi.value = output;

    }
    </script>
</div>

</body>
</html>